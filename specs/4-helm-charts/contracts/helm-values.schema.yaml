# Helm Value Definitions Schema
# Defines the structure and validation rules for values.yaml

title: "Todo Application Helm Chart Values"
description: "Schema for values.yaml configuration of the Todo application Helm chart"
type: "object"
properties:
  global:
    type: "object"
    description: "Global configuration values"
    properties:
      imagePullSecrets:
        type: "array"
        description: "List of image pull secrets"
        items:
          type: "string"
      storageClass:
        type: "string"
        description: "Default storage class for persistent volumes"
      namespaceOverride:
        type: "string"
        description: "Override namespace for deployment"

  frontend:
    type: "object"
    description: "Frontend service configuration"
    required:
      - "replicaCount"
      - "image"
    properties:
      replicaCount:
        type: "integer"
        description: "Number of frontend replicas"
        minimum: 1
        default: 1
      image:
        type: "object"
        description: "Frontend image configuration"
        required:
          - "repository"
          - "pullPolicy"
        properties:
          repository:
            type: "string"
            description: "Frontend image repository"
            default: "taskflow-frontend"
          tag:
            type: "string"
            description: "Frontend image tag"
            default: "latest"
          pullPolicy:
            type: "string"
            description: "Image pull policy"
            enum: ["Always", "Never", "IfNotPresent"]
            default: "IfNotPresent"
      service:
        type: "object"
        description: "Frontend service configuration"
        properties:
          type:
            type: "string"
            description: "Service type"
            enum: ["ClusterIP", "NodePort", "LoadBalancer"]
            default: "ClusterIP"
          port:
            type: "integer"
            description: "Service port"
            minimum: 1
            maximum: 65535
            default: 80
      resources:
        type: "object"
        description: "Frontend resource limits and requests"
        properties:
          limits:
            type: "object"
            description: "Resource limits"
            properties:
              cpu:
                type: "string"
                description: "CPU limit"
                default: "500m"
              memory:
                type: "string"
                description: "Memory limit"
                default: "512Mi"
          requests:
            type: "object"
            description: "Resource requests"
            properties:
              cpu:
                type: "string"
                description: "CPU request"
                default: "100m"
              memory:
                type: "string"
                description: "Memory request"
                default: "128Mi"
      env:
        type: "object"
        description: "Frontend environment variables"
        properties:
          API_URL:
            type: "string"
            description: "Backend API URL"
            default: "http://todo-backend:8000"

  backend:
    type: "object"
    description: "Backend service configuration"
    required:
      - "replicaCount"
      - "image"
    properties:
      replicaCount:
        type: "integer"
        description: "Number of backend replicas"
        minimum: 1
        default: 1
      image:
        type: "object"
        description: "Backend image configuration"
        required:
          - "repository"
          - "pullPolicy"
        properties:
          repository:
            type: "string"
            description: "Backend image repository"
            default: "taskflow-backend"
          tag:
            type: "string"
            description: "Backend image tag"
            default: "latest"
          pullPolicy:
            type: "string"
            description: "Image pull policy"
            enum: ["Always", "Never", "IfNotPresent"]
            default: "IfNotPresent"
      service:
        type: "object"
        description: "Backend service configuration"
        properties:
          type:
            type: "string"
            description: "Service type"
            enum: ["ClusterIP", "NodePort", "LoadBalancer"]
            default: "ClusterIP"
          port:
            type: "integer"
            description: "Service port"
            minimum: 1
            maximum: 65535
            default: 8000
      resources:
        type: "object"
        description: "Backend resource limits and requests"
        properties:
          limits:
            type: "object"
            description: "Resource limits"
            properties:
              cpu:
                type: "string"
                description: "CPU limit"
                default: "1000m"
              memory:
                type: "string"
                description: "Memory limit"
                default: "1Gi"
          requests:
            type: "object"
            description: "Resource requests"
            properties:
              cpu:
                type: "string"
                description: "CPU request"
                default: "250m"
              memory:
                type: "string"
                description: "Memory request"
                default: "256Mi"

  ingress:
    type: "object"
    description: "Ingress configuration"
    properties:
      enabled:
        type: "boolean"
        description: "Whether to enable ingress"
        default: false
      className:
        type: "string"
        description: "Name of ingress class"
      annotations:
        type: "object"
        description: "Annotations for ingress controller"
      hosts:
        type: "array"
        description: "List of hostnames for ingress"
        items:
          type: "object"
          properties:
            host:
              type: "string"
              description: "Hostname"
            paths:
              type: "array"
              description: "List of paths"
              items:
                type: "object"
                properties:
                  path:
                    type: "string"
                    description: "Path"
                    default: "/"
                  pathType:
                    type: "string"
                    description: "Path type"
                    enum: ["Prefix", "Exact", "ImplementationSpecific"]
                    default: "Prefix"
      tls:
        type: "array"
        description: "TLS configuration for ingress"
        items:
          type: "object"
          properties:
            secretName:
              type: "string"
              description: "Name of TLS secret"
            hosts:
              type: "array"
              description: "List of hosts for TLS"
              items:
                type: "string"

required:
  - "frontend"
  - "backend"